<div class='container-fluid'>

	<div class='row'>
		<div class='col-sm-2'></div>
		<div class='col-sm-8'>
			<h1> Welcome to your doggie dashboard <%=@owner.first_name%>!</h1>
		</div>
		<div class='col-sm-2'></div>
	</div>
	<!-- Only show the picture if there's one uploaded. 
	Without the if statement, a broken picture link shows up -->
	<% if @owner.image_file_name != nil%>
		<div class="row">
			<div class='col-sm-2'></div>
			<div class='col-sm-8'>
				<%= image_tag @owner.image.url(:thumb) %>
			</div>
			<div class='col-sm-2'></div>
		</div>
	<% end %>

	<div class='row'>
		<div class='col-sm-1'></div>
		<div class='col-sm-10'>
			<table>	
				<thead>
					<th>Dog details</th>
					<th>Fed breakfast?</th>
					<th>Fed dinner??</th>
					<th>Walked?</th>
					<th>Number treats given</th>
					<th>Notes</th>
					<th>Updated</th>
					<th>Last updated at</th>
				</thead>
				<tbody>
					<% @dogs.each do |dog| %>
					<!-- grab the last record, because that's the most updated one -->
					<% @dog_daily_status = Status.where(dog_id: dog.id).last%>
						<tr>
							<!-- This first column shows all the dog details that don't change on regular basis -->
							<td>
								<%= image_tag dog.image.url(:thumb)%>
								<br />
								<h3><%= dog.dog_name%> </h3>
								Food low: <%= check_box_tag 'food_low', 'yes', dog.food_low_flag, disabled:true%>
								<br />
								Treats low<%= check_box_tag 'treats_low', 'yes',dog.treats_low_flag, disabled:true%>
								<br />
								<%= link_to "Edit", edit_dog_path(dog) %><br/> 
								<%= link_to "See details", dog_path(dog) %><br />
								<%= link_to 'Delete relationship', relationship_path(owner_id: params[:id], dog_id: dog.id), method: :delete %>
							</td>
							<%= form_for @dog_daily_status, :url => { :controller => "statuses", :action => "update" } do |f| %>
								<td><%= f.check_box  :is_fed_breakfast %></td>
								<td><%= f.check_box :is_fed_dinner %></td>
								<td><%= f.check_box :is_walked %></td>
								
									<td><div class='tabledata3' style="height: 100%"><%= f.text_field :num_treats_given %></div></td>
								

								<td><%= f.text_area :notes %></td>
								<!-- Using a hidden field to pass the owner_id! -->
								<%= f.hidden_field :dog_id, :value => dog.id %> 
								<td><%= f.submit 'Save updates for dog status' %></td>
								<td><%= @dog_daily_status.updated_at %></td>
							<% end %>
						</tr>
					<% end %>
				</tbody>
			</table>
		</div>
		<div class='col-sm-1'></div>
	</div>
</div>

<p><%= link_to 'Add a new dog', new_dog_path(:owner_id => @owner.id) %></p> <!-- This lets you pass in a parameter of your own naming -->